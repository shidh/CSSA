#{extends 'main.html'/}


#{set 'moreStyles'}
	<link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/postStream.css'}">
#{/set}

<div class="row">
	<div class="col-sm-2"></div>
	<div class="col-sm-7">
		#{list items:posts, as:'onePost'}
		<div class="my-container">
			<div class="row my-title">
				<div class="col-sm-1">
					#{if mode == "post"} 
					<span class="label label-primary">新闻</span>
					#{/if}
					#{if mode == "event"} 
					<span class="label label-primary">活动</span>
					#{/if}					
				</div>
				<div class="col-sm-11">
					#{if mode == "post"} 
			        	<a class="h1" href="@{ViewPost.page(onePost.id)}">${onePost.title}</a>
					#{/if}
			        #{if mode == "event"} 
			        	<a class="h1" href="@{ViewEvent.page(onePost.id)}">${onePost.title}</a>
					#{/if}
				</div>
			</div>
			<div class="row">
				<div class="col-sm-4">
					<img src="/public/images/Events.jpg" alt="pic" class="img-thumbnail img-responsive">
				</div>
				<div class="col-sm-8 my-post-content">
					${onePost.postContent.raw()}
				</div>
			</div>
			<hr>
		</div>
		#{/list}
	</div>
	
	<!-- 
	<div class="col-sm-2">
		<div class="jumbotron">
		  <h4>热门文章</h4>
		  <ol class="list-unstyled">
			<li><a href="#">#全国雾霾# </a></li>
			<li><a href="#">#胖妹也性感# </a></li>
			<li><a href="#">#上厕所插队被拍板砖# </a></li>
			<li><a href="#">#天降六天小长假# </a></li>
			<li><a href="#">#诺贝尔文学奖# </a></li>
			<li><a href="#">#心疼村上春树# </a></li>
			<li><a href="#">#权志龙水原希子# </a></li>
		  </ol>
		</div>
		<h4>按月分类</h4>
		<ol class="list-unstyled">
			<li><a href="#">September 2014</a></li>
			<li><a href="#">August 2014</a></li>
			<li><a href="#">July 2014</a></li>
			<li><a href="#">June 2014</a></li>
			<li><a href="#">May 2014</a></li>
			<li><a href="#">April 2014</a></li>
			<li><a href="#">March 2014</a></li>
			<li><a href="#">February 2014</a></li>
			<li><a href="#">January 2014</a></li>
		</ol>
	</div> -->
	<div class="col-sm-1"></div>
</div>
<div class="row">
	<div class="col-sm-6 col-md-offset-4">
	<ul class="pagination">
	  <li><a href="javascript:void(0)" onclick="last()">&laquo;</a></li>
	  <li class="p"><a class="number" href="page?size=10&page=1">1</a></li>
	  <li class="p"><a class="number" href="page?size=10&page=2">2</a></li>
	  <li class="p"><a class="number" href="page?size=10&page=3">3</a></li>
	  <li class="p"><a class="number" href="page?size=10&page=4">4</a></li>
	  <li class="p"><a class="number" href="page?size=10&page=5">5</a></li>
	  <li><a href="javascript:void(0)" onclick="next()">&raquo;</a></li>
	</ul>
	</div>
</div>
<script>
// get pagination elements
var pagination = document.getElementsByClassName("pagination")[0];
var elements = pagination.getElementsByClassName("p");

// calculate the first number
var firstNumber = ${page} - (${page} -1) % 5;

// mark the current page as active
for(var i = 0;i < elements.length; i++){
	elements[i].outerHTML = "<li class='p'><a class='number' href='page?size=10&page="+firstNumber+"'>"+firstNumber+"</a></li>";
	var currentPN = elements[i].getElementsByClassName("number")[0].innerHTML;
	if(currentPN == "${page}"){
		elements[i].outerHTML = "<li class='p active'><a class='number'>" + currentPN + "</a></li>";
	}	
	firstNumber++;
}

// show the next five numbers
function next(){
	for(var i = 0;i < elements.length; i++){
		var currentPN = elements[i].getElementsByClassName("number")[0].innerHTML;
		var pageNumber = parseInt(currentPN) + 5;
		if(pageNumber == "${page}"){
			elements[i].outerHTML = "<li class='p active'><a class='number'>" + pageNumber + "</a></li>";
		}else{
			elements[i].outerHTML = "<li class='p'><a class='number' href='page?size=10&page=" + pageNumber + "'>" + pageNumber + "</a></li>";
		}
	}
}

// show the last five numbers
function last(){
	for(var i = 0;i < elements.length; i++){
		var currentPN = elements[i].getElementsByClassName("number")[0].innerHTML;
		var pageNumber = parseInt(currentPN) - 5;
		if(pageNumber <= 0) return;
		if(pageNumber == "${page}"){
			elements[i].outerHTML = "<li class='p active'><a class='number'>" + pageNumber + "</a></li>";
		}else{
			elements[i].outerHTML = "<li class='p'><a class='number' href='page?size=10&page=" + pageNumber + "'>" + pageNumber + "</a></li>";
		}
	}
}
</script>
